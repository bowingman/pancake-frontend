import { BigNumber, FixedNumber } from 'ethers'
import { formatBigNumber, formatBigNumberToFixed, formatFixedNumber } from 'utils/formatBalance'

describe('formatBigNumber', () => {
  it.each([
    ['13853728395577367836', 4, 18, '13.8537'],
    ['13853728395577367836', 18, 18, '13.853728395577367836'],
    ['13853728395577367836', 17, 18, '13.85372839557736783'],
    ['13853728395577367836', 16, 18, '13.8537283955773678'],
    ['13853728395577367836', 15, 18, '13.853728395577367'],
    ['13853728395577367836', 14, 18, '13.85372839557736'],
    ['13853728395577367836', 13, 18, '13.8537283955773'],
    ['13853728395577367836', 12, 18, '13.853728395577'],
    ['13853728395577367836', 11, 18, '13.85372839557'],
    ['13853728395577367836', 10, 18, '13.8537283955'],
    ['13853728395577367836', 9, 18, '13.853728395'],
    ['13853728395577367836', 8, 18, '13.85372839'],
    ['13853728395577367836', 7, 18, '13.8537283'],
    ['13853728395577367836', 6, 18, '13.853728'],
    ['13853728395577367836', 5, 18, '13.85372'],
    ['13853728395577367836', 4, 18, '13.8537'],
    ['13853728395577367836', 3, 18, '13.853'],
    ['13853728395577367836', 2, 18, '13.85'],
    ['13853728395577367836', 1, 18, '13.8'],
    ['13853728395577367836', 0, 18, '13.0'],
    ['2652487215692514844', 2, 18, '2.65'],
    ['1120124117988485', 3, 18, '0.001'],
    ['1120124117988485', 1, 18, '0.0'],
    ['207655447689', 2, 9, '207.65'],
    ['6652397734197674016', 8, 18, '6.65239773'],
    ['23810432295393761', 18, 18, '0.023810432295393761'],
    ['23810432295393761', 9, 18, '0.023810432'],
    ['23810432295393761', 1, 18, '0.0'],
    ['1000000000000000000', 1, 18, '1.0'],
    ['0', 1, 18, '0.0'],
    ['0', 2, 18, '0.0'],
  ])('correctly formats %s (%d, %d) correctly to %s', (value, displayDecimals, decimals, expected) => {
    const ethersBn = BigNumber.from(value)
    expect(formatBigNumber(ethersBn, displayDecimals, decimals)).toBe(expected)
  })
})

describe('formatBigNumberToFixed', () => {
  it.each([
    ['1000000000000000000', 2, 18, '1.00'],
    ['1000000000000000000', 6, 18, '1.000000'],
    ['1200000000000000000', 3, 18, '1.200'],
    ['1020100000000000000', 6, 18, '1.020100'],
    ['1000000000000000000', 0, 18, '1'],
  ])('correctly formats %s (%d, %d) correctly to %s', (value, displayDecimals, decimals, expected) => {
    const ethersBn = BigNumber.from(value)
    expect(formatBigNumberToFixed(ethersBn, displayDecimals, decimals)).toBe(expected)
  })
})

describe('formatFixedNumber', () => {
  it.only.each([
    ['29.487162603663381523', 2, 18, '29.48'],
    ['28.602547725553480077', 6, 18, '28.602547'],
    ['26.278587683044618393', 3, 18, '26.278'],
    ['3.20857492061876313', 6, 18, '3.208574'],
    ['24.687803148488403426', 0, 18, '24.0'],
    ['7.616553565521982679', 0, 18, '7.0'],
    ['17.834789886527917761', 0, 18, '17.0'],
    ['3.241', 0, 18, '3.0'],
    ['1.384', 0, 18, '1.0'],
    ['7.914500466722029957', 3, 18, '7.914'],
  ])('correctly formats %s (%d, %d) correctly to %s', (value, displayDecimals, decimals, expected) => {
    const ethersFn = FixedNumber.from(value)
    expect(formatFixedNumber(ethersFn, displayDecimals, decimals)).toBe(expected)
  })
})
